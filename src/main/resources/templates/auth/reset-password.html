<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - Assignment Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/reset-password.css}" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<!-- Floating shapes -->
<div class="shape"></div>
<div class="shape"></div>
<div class="shape"></div>

<div class="reset-container">
    <div class="reset-card">
        <!-- Logo -->
        <div class="logo-icon">
            <i class="bi bi-key-fill"></i>
        </div>

        <!-- Header -->
        <div class="text-center mb-4">
            <h1>Create New Password</h1>
            <p class="subtitle">Choose a strong password to secure your account</p>
        </div>

        <!-- Success Message -->
        <div th:if="${param.success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle-fill me-2"></i>
            <strong>Success!</strong> Your password has been updated
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Error Message -->
        <div th:if="${param.error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <strong>Error!</strong> <span th:text="${error}">Passwords do not match</span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Password Requirements -->
        <div class="password-requirements">
            <div class="requirement">
                <i class="bi bi-check-circle-fill"></i>
                <span>At least 8 characters long</span>
            </div>
            <div class="requirement">
                <i class="bi bi-check-circle-fill"></i>
                <span>Include uppercase and lowercase letters</span>
            </div>
            <div class="requirement">
                <i class="bi bi-check-circle-fill"></i>
                <span>Include at least one number</span>
            </div>
        </div>

        <form th:action="@{/auth/reset-password}" method="POST" id="resetForm">

            <!-- New Password -->
            <div class="form-floating mb-3 position-relative">
                <input type="password"
                       class="form-control"
                       id="newPassword"
                       name="newPassword"
                       placeholder="New Password"
                       required
                       minlength="8">
                <label for="newPassword">
                    <i class="bi bi-lock me-2"></i>New Password
                </label>
                <i class="bi bi-eye password-toggle" id="toggleNew"></i>
            </div>

            <!-- Confirm Password -->
            <div class="form-floating mb-4 position-relative">
                <input type="password"
                       class="form-control"
                       id="confirmPassword"
                       name="confirmPassword"
                       placeholder="Confirm Password"
                       required
                       minlength="8">
                <label for="confirmPassword">
                    <i class="bi bi-lock-fill me-2"></i>Confirm Password
                </label>
                <i class="bi bi-eye password-toggle" id="toggleConfirm"></i>
            </div>

            <!-- Update Button -->
            <button class="btn btn-primary w-100 mb-3" type="submit">
                <i class="bi bi-shield-check me-2"></i>
                Update Password
            </button>

            <!-- Back to Login -->
            <div class="text-center">
                <a th:href="@{/auth/login}" class="back-link">
                    <i class="bi bi-arrow-left"></i>
                    Back to Login
                </a>
            </div>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const card = document.querySelector('.reset-card');
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';

        setTimeout(() => {
            card.style.transition = 'all 0.6s ease-out';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, 100);

        // Password toggle
        const toggleNew = document.getElementById('toggleNew');
        const toggleConfirm = document.getElementById('toggleConfirm');
        const newPassword = document.getElementById('newPassword');
        const confirmPassword = document.getElementById('confirmPassword');

        toggleNew.addEventListener('click', () => {
            const type = newPassword.type === 'password' ? 'text' : 'password';
            newPassword.type = type;
            toggleNew.classList.toggle('bi-eye');
            toggleNew.classList.toggle('bi-eye-slash');
        });

        toggleConfirm.addEventListener('click', () => {
            const type = confirmPassword.type === 'password' ? 'text' : 'password';
            confirmPassword.type = type;
            toggleConfirm.classList.toggle('bi-eye');
            toggleConfirm.classList.toggle('bi-eye-slash');
        });

        // Password match validation
        const form = document.getElementById('resetForm');
        form.addEventListener('submit', (e) => {
            if (newPassword.value !== confirmPassword.value) {
                e.preventDefault();
                alert('Passwords do not match!');
                confirmPassword.focus();
            }
        });
    });
</script>
</body>
</html>
